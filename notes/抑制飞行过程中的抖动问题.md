# 抑制飞行过程中的抖动问题

[一种飞行模拟仿真画面去除抖动方法及飞行模拟器与流程 (xjishu.com)](https://www.xjishu.com/zhuanli/55/201910410194.html)

## 防抖技术（数码相机）

[相机防抖技术浅析 - 中国知网 (cnki.net)](https://kns.cnki.net/kcms/detail/detail.aspx?dbcode=CJFD&dbname=CJFDLAST2016&filename=GXQG201606038&uniplatform=NZKPT&v=OGmUJ0UVu5Ow2CE26SzCGL1IazcCFte2LIriDiJjhOBEPx8AEljGtAuPDNzz5yV7)

### 光学防抖

#### 镜头防抖

> 它由镜头内置的运动感应器（陀螺仪）侦测出镜头位移，微处理器由此信号计算出需要补偿的位移量，并驱动补偿镜片组在指定的方向进行位移补正。
> 
> 光学防抖的控制模型可应用PID控制进行建模。当控制量是恒值时，利用 PID 算法可以使被控量迅速达到控制量的设定范围内。

#### 机身防抖（影像传感器防抖）

> 其原理是将影像传感器安装在一个可动的运动平台上，根据机身运动感应器反馈的运动信号计算出相应的补偿量，驱动运动平台沿轴向或面向移动进而补偿抖动偏差。

### 电子防抖

> 电子防抖是利用数字图像处理技术对抖动图像进行后期优化从而尽可能地还原出原始清晰图像。另一种是逆向运算法，通过相机内置的运动感应器侦测出相机震动的方向，针对影像传感器的一部分面积进行分析并且通过逆向运算将模糊图像去掉。 

## 相关论文

### 1

[视觉系统防抖机构设计与动力学研究 - 中国知网 (cnki.net)](https://kns.cnki.net/kcms/detail/detail.aspx?dbcode=CMFD&dbname=CMFD2011&filename=2010026188.nh&uniplatform=NZKPT&v=CgSrBqaWI81t-ZwD9FxfK-7l_ETKW9nm0f1qeYszdkf-sR2OUMsXhs2GqvykE_ci)

思路：传感器测得抖动量（抖动前后相对地面位姿矩阵），计算抖动补偿量，通过关节的转动和移动进行抖动补偿。

### 2

 [一种视频防抖优化的无人机目标检测系统设计与实现 - 中国知网 (cnki.net)](https://kns.cnki.net/kcms/detail/detail.aspx?dbcode=CJFD&dbname=CJFDLAST2020&filename=JCGC202003011&uniplatform=NZKPT&v=h0s2RN7jUFMiL3Y98Dbo1omQecZnjypWcgHsa6TQ0X5dbq8S2YY0r-G3sVO3ob-T)

> 视频防抖优化算法
> 针对无人机在视频拍摄过程中由于自身运动和机体震动造成视频序列的抖动和模糊问题，本文首先提取摄像机真实全局运动参数，使用<mark>特征点匹配和仿射变换技术</mark>补偿摄像机运动干扰，使视频画面运行流畅且稳定。在提取每帧图像间特征点的基础之上，结合特征点匹配结果求得<mark>摄像机全局运动参数</mark>，接着利用此参数与仿射变换模型估算视频帧间的相对运动参数，以实现从抖动帧向基准帧间的纠正，达到连续拍摄视频图像的防抖动效果。

思路：特征点匹配+仿射变换

### 3

 [移动机器人视觉抖动的Kalman滤波补偿 - 中国知网 (cnki.net)](https://kns.cnki.net/kcms/detail/detail.aspx?dbcode=CJFD&dbname=CJFD2012&filename=JZDF201203030&uniplatform=NZKPT&v=ir5vikMLoXFIRSpqyYBvR7HVwquqqoK5zN8vC2dTDG66RF1YqhKdHued2NKyQhxO)

> KLT算法是 Kanade，Lucas，和 Tomasi 等人提出的一种利用空间亮度等级差异信息获取特征点的特征提取和跟踪算法。本文首先利用 <mark>KLT </mark>方法对图像进行特征提取; 其次对相邻 2 帧之间作特征匹配得到运动参数; 而后运用 <mark>Kalman 滤波</mark>方法去除无意运动;

思路：

1）图像的递推运动模型：仿射变换

2）特征点的定义和提取：特征窗口中心点为特征点，其特征值由KLT方法计算得到

3）自适应匹配搜索：菱形搜索( DS 法，Diamond Search) 算法

4）运动参数求解与 Kalman 滤波

5）运动补偿：补偿无意运动

### 4

 [图像成像过程中抖动补偿技术的研究 - 中国知网 (cnki.net)](https://kns.cnki.net/kcms/detail/detail.aspx?dbcode=CMFD&dbname=CMFD2012&filename=1011200287.nh&uniplatform=NZKPT&v=eH6HSRpz5NB2o-YDUohZxojfbimycrHgYpeQJ4xyNTo088LCo3oDFottmw3CrsUf)

> 图像在成像过程中因成像设备与被摄物体之间的相对运动导致的图像模糊称为运动模糊相机抖动导致的图像模糊属于运动模糊的一种。
> 
> 当成像设备与被摄物体之间产生相对运动时被摄物体的某一点成像时扩散为一条线这条线反应出成像设备与被摄物体之间相对运动的轨迹。而成像端数字图像中的每一个像素包含被摄物体多个点的信息也就是说数字图像中的像素与被摄物体的相应点不再一一对应,因而会导致图像模糊。
> 
> <mark>点扩散函数</mark>（Point Spread Funtion,简称PSF）是指输入物为一点光源时其输出像的光场分布。
> 
> 运动模糊图像的像素值是原始图像相应像素值与其时间的乘积的累加。
> 
> 数码相机成像过程中的抖动因距离较短，可将其近似为直线运动。
> 
> 光线较差曝光时间相对较短时，抖动持续时间大于曝光时间，抖动尚未结束曝光即已完成，曝光在抖动中完成，此时相机抖动可近似为匀速直线运动。将其归类于<mark>匀速直线运动导致的模糊失真</mark>（以下简称为运动模糊失真）。
> 
> 光线较差曝光时间相对较长时，抖动持续时间小于曝光时间，曝光过程涵盖抖动全过程，相机抖动是先加速后减速，起止瞬间处于静止，中间快速划过，图像呈现为<mark>双影模糊失真</mark>。
> 
> 运动模糊失真点扩散函数呈矩形。
> 
> 假设抖动过程是匀加速、匀减速运动，则点扩散函数可用斜坡型函数近似；假设抖动过程是变加速、变减速运动，则点扩散函数可用正弦形函数和抛物线型函数近似
> 
> 运动模糊图像<mark>恢复方法</mark>大致分为两类时域方法和频域方法。
> 
> 时域方法通过空间域的卷积实现，主要有差分恢复法和投影复原法。
> 
> 频域方法通过频域的相乘实现，主要有逆滤波、维纳滤波、约束卷积等方法。



主要恢复方法：

逆滤波：FFT（快速傅里叶变换）实现

维纳滤波（最小二乘滤波）：是使原始图像及其恢复图像之间的均方误差最小的恢复方法。

差分恢复

盲目恢复：从观察图像中以某种方式抽出退化信息从而找出图像恢复方法。

> 对具有加性噪声的模糊图像作盲目图像恢复的方法有两种：直接测量法和间接估计法。
> 
> <mark>直接测量法</mark>盲目图像恢复通常要测量图像的模糊脉冲响应和噪声功率谱或协方差函数。在所观察的景物中往往点光源能直接指示出冲激响应。另外图像边缘是否陡峭也能用来推测模糊冲激响应。在背景亮度相对恒定的区域内测量图像的协方差可以估计出观测图像的噪声协方差函数。
> 
> <mark>间接估计法</mark>盲目图像恢复类似于多图像平均法处理。




> 抖动模糊<mark>方向</mark>是指图像的抖动方向与水平轴的夹角，若能测出抖动图像模糊角度，通过图像旋转可将抖动模糊方向旋转到水平轴，图像的恢复可由二维问题转化为一维问题。
> 
> 基于运动模糊图像二维频谱的Radon变换的估计法：
> 
> 如果图像是其他方向的运动模糊，则相应的条纹将出现在与运动方向垂直的方向上，检测这些条纹的方向就可得到模糊方向。如果将这些条纹看成直线，通过检测直线的方式就可鉴定出模糊方向。
> 
> 抖动模糊<mark>尺度</mark>是指用被拍摄物体和成像系统之间相对移动的像素数。
> 
> 基于运动模糊图像微分自相关的估计法：
> 
> 将旋转后的模糊图像在水平方向上进行一阶微分，然后在水平方向上求微分图像的自相关并将自相关图像的各列加起来得到一条鉴别曲线，在鉴别曲线上的零频尖峰两侧会对称地出现一对共扼的负相关峰，两负相关峰间的距离等于运动模糊点扩散函数尺度的两倍。因此鉴别出这两个相关峰的位置就可以得出运动模糊点扩散函数尺度。



运动模糊失真恢复的具体步骤如下：
1）确定抖动模糊方向和抖动模糊尺度
2）调用MATLAB图像处理工具箱中的fspecial函数建立点扩散函数
3）调用MATLAB图像处理工具箱中的deconvwnr函数进行图像恢复

双影模糊失真恢复的具体步骤如下：
1）确定抖动模糊方向和抖动模糊尺度
2）对抖动模糊图像进行旋转，将二维问题简化为一维问题
3）建立双影模糊失真点扩散函数
4）调用MATLAB图像处理工具箱中的deconvwnr函数进行图像恢复
5）将恢复图像转回原角度并按原分辨率进行裁剪得到恢复图像

### 5

[一种鲁棒性的抖动视频稳像算法 - 中国知网 (cnki.net)](https://kns.cnki.net/kcms/detail/detail.aspx?dbcode=CJFD&dbname=CJFD2008&filename=GDZJ200803029&uniplatform=NZKPT&v=K2jT-7M7P9yYnZ4O4fieHFwM-MAORmXnOcCIE75rNdDwQ0csXGYOPEAWC75Dw0TF)

> 视频稳像算法框架
> 本文算法的基本步骤为：　　
> 
> 1）对输入图像序列进行高斯平滑去除噪声；　
> 
> 2）利用Shi等人提出的<mark>特征提取</mark>算法选取利于匹配的特征；　　
> 
> 3）结合亮度变化自适应模型对<mark>KLT</mark>匹配器进行优化得到特征初步匹配结果；　　
> 
> 4）通过特征误差分析和运动一致性规则对特征集进行有效性验证以减少因遮挡和前景运动物体产生的无效特征获取有效特征集合；　　
> 
> 5）基于有效特征集在帧间的对应关系求得运动参数；　　
> 
> 6）根据运动参数判断视频序列是否发生抖动,若图像无抖动直接输出当前图像并读取下一帧,否则转向抖动补偿模块；

思路：（与论文23相似）

1）亮度无关特征匹配：

采用Shi等人［1 ］的特征提取方法[TR_93-1399_Cornell.pdf (duke.edu)](https://users.cs.duke.edu/~tomasi/papers/shi/TR_93-1399_Cornell.pdf)

opencv：[goodFeaturesToTrack函数详细注释_xdfyoga1的博客-CSDN博客_goodfeaturestotrack](https://blog.csdn.net/xdfyoga1/article/details/44175637?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-44175637-blog-121762965.pc_relevant_aa_2&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-44175637-blog-121762965.pc_relevant_aa_2&utm_relevant_index=2)

以Affine模型做特征匹配，特征匹配的目标是特征区域在不同视频帧中像素灰度值差的平方和SSD最小。

对整体亮度变化进行线性调整。

2）特征有效性判定：

根据高斯分布，取误差在3σ以内的特征。

根据运动一致性原则，首先获得当前第k帧中的某个特征相对于模版帧的运动向量，而后确定单特征的运动向量和平均运动向量间模及方向角的偏差。若偏差超出某个预定的阈值则标识该特征为无效特征。

3）抖动检测：

分别对x方向和y方向进行抖动检测，当某一方向上发生方向变化的视频帧数目l超出特定阈值时认为视频在该方向存在抖动需要进行抖动补偿。

4）抖动补偿：

采用基于均值滤波平滑的算法

利用相邻帧信息获得第j帧的运动参数矩阵，采用Affine模型进行抖动补偿。


